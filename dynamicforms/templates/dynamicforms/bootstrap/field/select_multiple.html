{% extends DYNAMICFORMS.field_base_template %}
{% load i18n dynamicforms %}
{% trans "No items to select." as no_items %}
{% block field_input %}
<select multiple {{ field.choices|yesno:",disabled" }} id="{{ field.uuid }}" class="form-control {{ DYNAMICFORMS.select2_form_field_class }} {% if field.errors %}is-invalid{% endif %}" style="width: 100%" name="{{ field.name }}">
  {% for select in field.iter_options %}
    {% if select.start_option_group %}
      <optgroup label="{{ select.label }}">
    {% elif select.end_option_group %}
      </optgroup>
    {% else %}
      <option value="{{ select.value }}" {% if select.value|as_string in field.value|as_list_of_strings %}selected{% endif %} {% if select.disabled %}disabled{% endif %}>{{ select.display_text }}</option>
    {% endif %}
  {% empty %}
    <option>{{ no_items }}</option>
  {% endfor %}
</select>

{% if DYNAMICFORMS.use_select2 %}
  <script type="text/javascript">
    // Check bootstrap version to set select2 theme
    $("#{{ field.uuid }}").select2({
      // Attaches select2 to its form parent and enables input field (in dialog)
      dropdownParent: $('#{{ style.serializer.uuid }}')
     {# TODO: #165 theme setting is commented because currently does't look good with bootstrap4 theme... #}
     {#  (options in mutiple lines, too narrow borders) #}
     {#, theme: '{{ DYNAMICFORMS.select2_theme }}'#}

    });
  </script>
{% endif %}

{% endblock %}
